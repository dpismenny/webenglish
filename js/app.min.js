jQuery(function(a){"use strict";function b(a){return(a>9?"":"0")+a}function c(a,c){a=parseInt(a||0,10),a=c?Math.round(a/1e3):a;var d=Math.floor(a/3600),e=Math.floor(a%3600/60),f=a%60,g=(d?"{hours}:":"")+"{minutes}:{seconds}";return g.replace("{hours}",b(d)).replace("{minutes}",b(e)).replace("{seconds}",b(f))}var d=a(window),e=a(document);a.ajaxSetup({cache:!1,dataType:"json"});var f=200,g=200,h=3e3;a.fn.unselectable=function(){return a(this).attr("unselectable","on").css("user-select","none").on("selectstart",!1)},function(){var b={popup:_.template(a("#tpl_notification_popup").html()),error:_.template(a("#tpl_notification_error").html())};d.on("create_notification",function(c,d){var e,f=a(b[d.type](d)),g=a(".js-close",f);f.on("close",function(){f.fadeOut(function(){f.off().remove()}),clearTimeout(e),e=null}).appendTo("body").fadeIn(),g.click(function(){return f.trigger("close"),!1}),d.timeout&&setTimeout(function(){f.trigger("close")},1e3*d.timeout)}).on("create_popup",function(b,c){c=a.extend({type:"popup",timeout:5,message:""},c||{}),d.trigger("create_notification",c)}).on("create_error",function(b,c){c=a.extend({type:"error",timeout:3,title:"Error",message:""},c||{}),d.trigger("create_notification",c)}),a(".js-noty").on("click",".js-close",function(){return a(this).closest(".js-noty").fadeOut(f),!1})}(),function(b){b&&(d.one("sm2_init",function(){b.setup({url:"/js/soundmanager2/swf/",preferFlash:!1,onready:function(){d.trigger("sm2_ready")},ontimeout:function(){throw new Error("SoundManager2 init error")}})}),a.fn.jsplayer=function(e){return e=e||{},a(this).each(function(){var f=a(this),g=a(".js-player-time",f),h=a(".js-playpause",f),i=a(".js-bar",f),j=a(".js-notch",f),k=i.parent(),l=f.data("url")||e.url,m=(f.data("volume")||e.volume||100,!!f.data("autoplay")||e.autoplay),n=!!f.data("autoload")||e.autoload,o=!!f.data("onlyback")||e.onlyback,p=h.data("pause")||e.classPause,q=h.data("play")||e.classPlay;if(f.data("jsplayer_added"))return!1;f.on("do_init",function(){r.position>0||(r.loaded?r.play():r.load(),h.off(".init"))}).on("do_stop",function(){r.stop(),j.hide()}).on("error",function(){f.addClass("is-hold"),d.trigger("create_popup",{message:"Error – audio file was not loaded"})}).on("time",function(a,b){g.html((b.positive?"":"-")+c(b.ms,!0))}).on("bar",function(){var a=100*(r.position/r.duration);a=a.toFixed(2),i.width(a+"%")}).on("notch",function(){var a=r.maxPosition/r.duration;1!==a&&(a*=100,a=a.toFixed(2),j.show().css("left",a+"%"),f.on("bar.notch",function(){r.position<r.maxPosition||(j.hide(),f.off(".notch"))}))}).on("play_state",function(){h.removeClass(q).addClass(p)}).on("pause_state",function(){h.removeClass(p).addClass(q)}).data("jsplayer_added",!0),k.click(function(b){if(!a(b.target).closest(".js-notch").length&&r.loaded&&r.duration){var c=(b.offsetX||b.originalEvent.layerX||0)/k.width();if(c*=r.duration,o){if(c>r.maxPosition)return;f.trigger("notch")}r.setPosition(c),f.trigger("time",{ms:r.duration-r.position}).trigger("bar")}});var r=b.createSound({url:l,autoLoad:n,autoPlay:m,onload:function(){return this.loaded?(f.trigger("time",{ms:this.duration}),h.off().click(a.proxy(function(){this.paused||0===this.playState?this.play():this.pause()},this)),this.play(),void 0):f.trigger("error")},onplay:function(){f.trigger("play_state")},onresume:function(){f.trigger("play_state")},onpause:function(){f.trigger("pause_state")},onstop:function(){this.setPosition(0),f.trigger("pause_state").trigger("time",{ms:this.duration,positive:!0}).trigger("bar")},onfinish:function(){f.trigger("finish").trigger("pause_state").trigger("time",{ms:this.duration,positive:!0}).trigger("bar")},whileplaying:function(){this.maxPosition=Math.max(this.maxPosition||0,this.position),f.trigger("time",{ms:this.duration-this.position}).trigger("bar")},volume:100});h.one("click.init",function(){f.trigger("do_init")})})},d.one("sm2_ready",function(){a(".js-player").jsplayer({test:!0})}),a(".js-player").length&&d.trigger("sm2_init"))}(window.soundManager),function(){a.fn.auditWrap=function(){d.trigger("sm2_init");var b=a(this);return b.each(function(){var e=a(this),f=a(".js-player-empty",e),h=null,i=e.data(),j=i.active,k=i.form,l=i.cancel,m=!1;if(!k||!l||!j)throw new Error("Missing required data-attribites for audit element");e.on("timer_start",function(b,d){var e=null,f=a(".js-audit-time",h),g=function(){d--,f.text(c(d)),0>=d&&h.trigger("timerdone")};h.on("closeend timerdone",function(){clearInterval(e),e=null}),e=setInterval(g,1e3),g()}).on("init_form",function(){var c=a(".js-audit-buttons",h),i=a(":submit",c),k=a(".js-audit-more",h);if(h.off().on("timerdone",function(){e.removeClass(j),h.trigger("close"),d.trigger("create_popup",{message:"Your complain review session has timed out"})}).on("close",function(){h.slideUp(g,function(){h.trigger("closeend").off().remove()}),f.trigger("do_stop"),b.removeClass("is-hold")}).appendTo(e).slideDown(g,function(){m=!1}),k.length){k.submit(function(){return a.ajax(k.data("submit"),{type:k.attr("method"),data:h.serialize(),success:function(){h.on("closeend",function(){e.off().remove()}).trigger("close")},error:function(){d.trigger("create_error",{message:"Server failed – could not complete the refund claim"})}}),!1});var l=k.find(":checkbox");l.click(function(){this.checked&&l.not(this).prop("checked",!1),l.each(function(){a(this).parent().next().toggle(this.checked).find("textarea").prop("disabled",!this.checked)})})}i.click(function(){var b=a(this),f=b.attr("name");return b.hasClass("is-disabled")?!1:(k.length&&"correct"===f?(k.slideDown(g),c.hide()):a.ajax(h.data("evaluate"),{type:"POST",data:{state:f},success:function(){h.on("closeend",function(){e.off().remove()}).trigger("close")},error:function(){d.trigger("create_error",{message:"correct"===f?"Server failed – could not complete the refund claim":"Server failed – could not cancel the refund claim"})}}),void 0)})}).on("req_form",function(){m=!0,a.ajax(k,{success:function(c){e.addClass(j),b.not("."+j).addClass("is-hold"),h=a(c.html),e.trigger("init_form").trigger("timer_start",c.time_left),c.file&&f.jsplayer({url:c.file}).on("finish",function(){h.find(":submit").removeClass("is-disabled")}).trigger("do_init")},error:function(){d.trigger("create_error",{message:"Server failure – the claim form could not be loaded"}),m=!1}})}).on("req_cancel",function(){m=!0,a.ajax(l,{success:function(){b.removeClass(j).removeClass("is-hold"),h.on("closeend",function(){m=!1}).trigger("close")},error:function(){d.trigger("create_error",{message:"Server failed – the refund claim could not be cancelled"}),m=!1}})}).on("click",function(b){if(m||e.hasClass("is-hold"))return!0;var c=a(b.target),d=c.closest(".js-button-cancel").length;return!d&&e.hasClass(j)?!0:(e.trigger(d?"req_cancel":"req_form"),c.is("a")?!1:void 0)})})},a(".js-audit-row").auditWrap()}(),function(){a.fn.evaluationWrap=function(){var b=a(this),e=_.template(a("#tpl_evaluation_info").html()),f=_.template(a("#tpl_evaluation_player").html());return d.trigger("sm2_init"),b.each(function(){var h,i,j,k,l,m,n,o=a(this),p=0,q=-1,r=o.data(),s=!1;o.on("next",function(){return q++,n.dialogs[p]?n.dialogs[p].speeches[q]?(i.each(function(b){a(this).addClass(p>b?"is-done":p===b?"is-active":"")}),o.trigger("toggle_button",!1).trigger("init_speech"),void 0):(p++,q=-1,o.trigger("next")):o.trigger("remove")}).on("init_speech",function(){var b=n.dialogs[p].speeches[q],c=b.origin,e=b.translated;o.trigger("add_player",c),l.on("finish",function(){o.trigger("add_player",e),l.trigger("do_init").on("finish",function(){o.trigger("toggle_button",!0),j.off().one("click.ajax",function(){return j.off(".ajax"),a.ajax(r.post,{type:"POST",data:{state:a(this).data("value"),id:b.id},error:function(){d.trigger("create_error",{message:"Server failure – could not assess speech in tests"})},success:function(){o.trigger("next")}}),!1}).click(function(){return!1})})})}).on("init_dialogs",function(){h=a(e(n)),m=a(".js-player-wrap",h),j=a(".js-evaluation-button",h),k=a(".js-evaluation-time",h),i=a(".js-steps li",h),h.insertAfter(o),o.trigger("next").trigger("open")}).on("init_timer",function(a,b){var e=null,f=function(){b--,k.text(c(b)),0>=b&&(o.trigger("remove"),d.trigger("create_popup",{message:"Your test has timed out"}))};o.on("close remove",function(){clearInterval(e),e=null}),e=setInterval(f,1e3),f()}).on("add_player",function(b,c){l&&l.off().remove(),l=a(f({url:c})),l.appendTo(m).jsplayer().trigger("do_init")}).on("toggle_button",function(a,b){j.toggleClass("is-disabled",!b).click(function(){return!1})}).on("open",function(){o.addClass("is-active").trigger("init_timer",n.left_time),b.not(".is-active").addClass("is-hold"),l.trigger("do_init"),h.slideDown(g)}).on("close",function(){o.removeClass("is-active"),b.removeClass("is-hold"),l.trigger("do_stop"),h.slideUp(g)}).on("remove",function(){l.trigger("do_stop"),o.add(j).add(l).off(),h.slideUp(g,function(){h.remove(),o.remove(),b.removeClass("is-hold")})}).click(function(){return s||o.hasClass("is-hold")?!1:h?(o.trigger(h.is(":visible")?"close":"open"),!1):(s=!0,a.ajax(r.url,{success:function(a){n=a,o.trigger("init_dialogs")},complete:function(){s=!1},error:function(){d.trigger("create_error",{message:"Server failure – could not retrieve the list of dialogues"})}}),!1)})})},a(".js-evaluation").evaluationWrap()}(),function(){a.fn.feedbackWrap=function(){var b=a(this);return b.each(function(){var c=a(this),d=a(".js-player-wrap",c),e=a(".js-player",d),f=!1;c.on("close",function(){f=!1,d.hide(),e.trigger("do_stop")}).on("click",function(h){return a(h.target).closest(".js-player-wrap").length?!1:(f=!f,d[f?"slideDown":"slideUp"](g,function(){e.trigger(f?"do_init":"do_stop"),f&&b.not(c).trigger("close")}),void 0)})})},a(".js-feedback-row").feedbackWrap()}(),function(){function b(a,b){return a=a.toFixed(1),a=a.toString(),a=a.replace(".",","),(b?"&euro;":"")+a}if(a(".js-cost").length){var c=a(".js-cost").unselectable(),f=a(".js-plus",c),g=a(".js-minus",c),h=a(".js-cost-value",c),i=a(".js-slider",c),j=a(".js-slider-bar",i),k=a(".js-slider-button",i),l=c.data("url"),m=c.data("cost"),n=c.data("maxcost"),o=c.data("mincost"),p=j.width()-k.width(),q=0,r=.1;f.click(function(){return c.hasClass("is-disabled")?!1:(m=Math.min(n,m+r),h.add(i).trigger("update"),!1)}),g.click(function(){return c.hasClass("is-disabled")?!1:(m=Math.max(o,m-r),h.add(i).trigger("update"),!1)}),d.on("phone_status",function(a,b){c.add(k).toggleClass("is-disabled","pickup"===b||"hangup"===b)}),h.on("update",function(){h.html(b(m,!0)),a.ajax(l,{type:"POST",data:{cost:m.toFixed(1)},complete:function(){}})}),i.on("init",function(){var a,b;k.mousedown(function(d){return c.hasClass("is-disabled")?!1:(a=d.clientX,b=q,e.on("mousemove.slider",function(c){var d=c.clientX-a;q=b+d,q=Math.min(q,p),q=Math.max(q,0),i.trigger("reverse_update")}).on("mouseup.slider",function(){e.off(".slider"),h.trigger("update")}),void 0)})}).on("reverse_update",function(){m=o+q/p*(n-o),k.css("left",q+"px").html(b(m))}).on("update",function(){q=(m-o)/(n-o)*p,k.css("left",q+"px").html(b(m))}).trigger("update").trigger("init")}}(),function(){if(a(".js-menu").length){var b,c=a(".js-menu"),e=c.data("sound");e&&d.trigger("sm2_init").on("sm2_ready",function(){b=soundManager.createSound({url:e,autoLoad:!0,autoPlay:!1,volume:100})}),d.on("menu_update",function(d,e){var f=!1;a.each(e,function(b,d){var e,g=a(".js-menu-"+b,c),h=g.parent();g.length&&(e=parseInt(g.text(),10),g.html(d),e!==d&&d>e&&(f=!0,h.animate({color:"#00adef"},700)))}),f&&b&&b.play()})}}(),function(){if(a(".js-queue").length){var b=a(".js-queue-summary"),c=a(".js-queue-details"),e=a(".js-position",b),f=a(".js-favorites"),i=a(".js-favorites-all",f),j=a(".js-favorites-online",f),k=_.template(a("#tpl_queue").html()),l=b.data("url"),m=b.data("url"),n=!1,o=!1;b.add(c).on("click",".js-toggle",function(){return n=!n,b.slideToggle(g),c.slideToggle(g),!1}),c.on("update",function(a,b){for(var d,e=0,f=0;e<b.translators.length;e++)d=b.translators[e],d.price=d.price.toString().replace(".",","),d.newprice=f!==d.price,f=d.price;c.find(".js-queue-block").remove(),c.append(k(b))}),b.on("update",function(a,b){e.text(b.position)}),f.on("update",function(a,b){i.text(b.favorites.all),j.text(b.favorites.online)}),setInterval(function(){o||(o=!0,a.ajax(n?m:l,{success:function(a){a.translators&&c.trigger("update",a),a.position&&b.trigger("update",a),a.favorites&&f.trigger("update",a),a.menu&&d.trigger("menu_update",a.menu)},error:function(){},complete:function(){o=!1}}))},h)}}(),function(){function b(){if(null===i){try{i=document.getElementById("webphone")}catch(a){}if(null===i){var b=null;try{b=document.applets,0===b.length&&(b=document.getElementsByTagName("object")),0===b.length&&(b=document.getElementsByTagName("applet"));for(var c=0;c<b.length;++c)try{if("undefined"!=typeof b[c].API_Call){i=b[c];break}}catch(a){}}catch(a){}if(null===i)try{i=document.applets[0]}catch(a){}}if(null!==i)try{var d=i.getSubApplet();null!==d&&(i=d)}catch(a){}}}if(window.phone){if(window.deployJava){var c=deployJava.getJREs();c&&c.length||d.trigger("create_popup",{message:'You need to <a target="_blank" href="http://www.java.com/getjava">install Java</a>, to be able to take calls from customers',timeout:0})}a("#deployJavaPlugin").hide();var e,f=200,g=500,h=1e4,i=null,j=[],k=[];for(e in phone.attributes)phone.attributes.hasOwnProperty(e)&&j.push(e+'="'+phone.attributes[e]+'"');for(e in phone.parameters)k.push("<param name='"+e+"' value='"+phone.parameters[e]+"'/>");a("<div/>").html("<applet "+j.join(" ")+">"+k.join("")+"</applet>").appendTo("body"),b();var l=a(".js-phone"),m=a(".js-phone-button"),n=a("[data-stanby]",m),o=a(".js-phone-status"),p=a(".js-phonefail"),q=null,r=p.data("delay"),s=o.data("on"),t=o.data("off"),u=o.data("wait"),v=o.data("texton"),w=o.data("textoff"),x=o.data("textwait"),y=["Ready","Register…","Registering…"],z=["Register Failed"],A=!0,B="";r=parseInt(r,10),r=r?1e3*r:h,m.on("growup",function(){m.animate({transform:"scale(1.1)"},g,"swing",function(){m.trigger("growdown")})}).on("growdown",function(){m.stop().animate({transform:"scale(0.9)"},g,function(){m.trigger("growup")})}).on("status",function(a,b){if(b!=B&&(B=b,d.trigger("phone_status",B)),m.toggleClass("is-standby","standby"==b).toggleClass("is-pickup","pickup"==b).toggleClass("is-hangup","hangup"==b),"pickup"==b){if(!A)return;A=!1,m.stop().trigger("growup")}else A=!0,m.stop().css("transform","scale(1)")}),o.on("status",function(b,c){var d,e,f;-1!==a.inArray(c,z)?d=!0:-1!==a.inArray(c,y)?f=!0:e=!0,o.toggleClass(s,!!e).toggleClass(t,!!d).toggleClass(u,!!f).text(d?w:f?x:v)}),q=setTimeout(function(){p.removeClass("is-hidden")},r),setInterval(function(){if(!i)return b();var c;try{c=i.API_GetStatus(-2)}catch(d){return b()}switch(c=a.trim(c),o.trigger("status",c),l.trigger("inited"),c){case"Incoming...":m.trigger("status","pickup").off(".phone").one("click.phone",function(){return i.API_Accept(i.API_GetLine()),!1});break;case"Registered.":m.trigger("status","standby");break;case"Call Finished":m.trigger("status","standby");break;default:-1!==c.indexOf("Speaking")||-1!==c.indexOf("In Call")?m.trigger("status","hangup").off(".phone").one("click.phone",function(){return i.API_Hangup(i.API_GetLine()),!1}):m.trigger("status","standby")}},f),l.one("inited",function(){clearTimeout(q),q=null,n.length&&n.text(n.data("stanby")),d.on("beforeunload",function(){return"If you leave this page now, you will not be able to take calls, and you will lose your place in the queue."})})}}(),a(".js-auth").click(function(){var b=a(this),c=a(".js-popups");return b.hasClass("is-open")?(b.removeClass("is-open"),c.fadeOut()):(c.fadeOut(),b.addClass("is-open").next().fadeIn()),!1}),a(".chzn-select").chosen({disable_search_threshold:100}),a(".js-accord-body").hide(),a(".js-accord-body1").show(),a(".js-accord").click(function(){var b=a(this);b.toggleClass("is-active").next()[b.hasClass("is-active")?"slideDown":"slideUp"]("fast")}),a(".account__list li").not(".account__more").click(function(){return a(this).toggleClass("is-selected"),!1})});