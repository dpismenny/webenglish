jQuery(function(a){"use strict";function b(a){return(a>9?"":"0")+a}function c(a,c){a=parseInt(a||0,10),a=c?Math.round(a/1e3):a;var d=Math.floor(a/3600),e=Math.floor(a%3600/60),f=a%60,g=(d?"{hours}:":"")+"{minutes}:{seconds}";return g.replace("{hours}",b(d)).replace("{minutes}",b(e)).replace("{seconds}",b(f))}var d=a(window);a.ajaxSetup({cache:!1,dataType:"json"}),function(){function b(b,d){var e=null,f=a(".js-audit-time",b),g=function(){d--,f.text(c(d)),0>=d&&b.trigger("timerdone")};b.on("closeend timerdone",function(){clearInterval(e),e=null}),e=setInterval(g,1e3),g()}a(".js-audit-row").each(function(){function c(b,c){return c=c||{},c.name?(a('[name="mvt_opinion[accepted]"]',f).attr("checked","yes"==c.name),a.ajax(f.attr("action"),{type:f.attr("method"),data:f.serialize(),complete:function(){f.on("closeend",function(){d.off().remove()}).trigger("close")}}),!1):!1}var d=a(this),e=a(".js-player",d),f=null,g=d.data(),h=!1;d.on("click",".js-button-audit, .js-button-cancel",function(){if(h)return!1;var i,j,k=a(this),l=k.hasClass("js-button-audit"),m=k.hasClass("js-button-cancel");if(g.form&&l)i=!0,j=g.form;else{if(!g.cancel||!m)return!1;i=!1,j=g.cancel}return h=!0,a.ajax(j,{success:function(j){g.active&&d.toggleClass(g.active,i),j.form?(f=a(j.form),f.on("timerdone",function(){d.removeClass(g.active),f.trigger("close")}).on("close",function(){f.slideUp(function(){f.trigger("closeend").off().remove()}),e.data("sound").stop()}).submit(c).appendTo(d).slideDown(function(){h=!1}).find(":submit").click(function(){f.trigger("submit",{name:this.name})}),j.time_left&&b(f,j.time_left),e.trigger("init")):f&&f.length?f.on("closeend",function(){h=!1}).trigger("close"):h=!1},error:function(){h=!1}}),!1})})}(),function(b){b&&a(".js-player").length&&(b.setup({url:"/js/soundmanager2/swf/",preferFlash:!1,onready:function(){d.trigger("sm2ready")},ontimeout:function(){}}),d.on("sm2ready",function(){a(".js-player").each(function(){var d=a(this),e=a(".js-player-time",d),f=a(".js-playpause",d),g=a(".js-bar",d),h=!!d.data("autoplay"),i=f.data("pause"),j=f.data("play"),k=d.data("url");d.on("init",function(){f.off(".init"),l.position>0||(l.loaded?l.play():l.load())}).on("error",function(){d.addClass("is-hold")}).on("time",function(a,b){e.html("-"+c(b,!0))}).on("bar",function(a,b){var c=100*(b.position/b.duration);c=c.toFixed(2),g.width(c+"%")}).on("play_state",function(){f.removeClass(j).addClass(i)}).on("pause_state",function(){f.removeClass(i).addClass(j)});var l=b.createSound({url:k,autoLoad:!1,autoPlay:h,onload:function(){return this.loaded?(d.trigger("time",this.duration),f.click(a.proxy(function(){this.paused||0===this.position?this.play():this.pause()},this)),this.play(),void 0):d.trigger("error")},onplay:function(){d.trigger("play_state")},onresume:function(){d.trigger("play_state")},onpause:function(){d.trigger("pause_state")},onstop:function(){this.setPosition(0),d.trigger("pause_state").trigger("time",this.duration).trigger("bar",this)},onfinish:function(){this.setPosition(0),d.trigger("pause_state").trigger("time",this.duration).trigger("bar",this)},whileplaying:function(){d.trigger("time",this.duration-this.position).trigger("bar",this)},volume:100});f.one("click.init",function(){d.trigger("init")}),d.data("sound",l)})}))}(window.soundManager),function(){if(a("#tpl_evaluation_info").length){var b=a("#tpl_evaluation_info").html();b=_.template(b),a(".js-evaluation").each(function(){var c=a(this),d=null;c.data(),c.click(function(){return d?d.slideToggle():(d=a(b({dialogs:[]})),d.insertAfter(c).slideDown(),void 0)})})}}(),a(".js-auth").click(function(){var b=a(this),c=a(".js-popups");return b.hasClass("is-open")?(b.removeClass("is-open"),c.fadeOut()):(c.fadeOut(),b.addClass("is-open").next().fadeIn()),!1}),a(".chzn-select").chosen({disable_search_threshold:100}),a(".js-accord-body").hide(),a(".js-accord-body1").show(),a(".js-accord").click(function(){var b=a(this);b.toggleClass("is-active").next()[b.hasClass("is-active")?"slideDown":"slideUp"]("fast")}),a(".account__list li").not(".account__more").click(function(){return a(this).toggleClass("is-selected"),!1})});